## 🎯 LSTM 주가 방향성 예측 모델 방법론

### 📊 **1단계: 데이터 통합 및 전처리**

#### 시간 동기화
- **기준점**: 주가 데이터의 1시간 간격을 기준으로 설정
- **뉴스 데이터**: `pubDate`를 1시간 구간별로 집계
- **트위터 데이터**: `created_at`을 1시간 구간별로 집계
- **주가 데이터**: 기존 1시간 간격 그대로 활용

#### 감정 데이터 집계 방법
```
각 1시간 구간마다:
- 뉴스: finbert_positive/neutral/negative 평균값, 뉴스 개수, 변동성
- 트위터: VADER 점수 평균값, 트윗 개수, 인플루언서 가중치
```

### 🔧 **2단계: 특성 공학 (Feature Engineering)**

#### 감정 특성
- **뉴스 감정**: 시간별 평균, 가중평균, 표준편차, 모멘텀
- **트위터 감정**: 사용자별 가중치 적용, 감정 극값, 변화율
- **감정 조합**: 뉴스-트위터 감정 상관관계, 감정 격차

#### 주가 기술적 특성
- **기존 지표**: RSI, MACD, 볼린저밴드, 이동평균
- **거래량 패턴**: 거래량 급증, 시간대별 패턴
- **변동성 지표**: 변동성 클러스터링, 갭 발생

### 🎯 **3단계: 타겟 변수 생성**

#### 방향성 분류 기준 (추천)

```python
# 1시간 후 주가 변화율 기준
change_threshold = 0.5%  # 임계값 (조정 가능)

if 미래_가격_변화율 >= +0.5%:
    label = "pos" (상승)
elif 미래_가격_변화율 <= -0.5%:
    label = "neg" (하락)  
else:
    label = "neu" (유지)
```

#### 동적 임계값 방법
- 최근 20일 변동성을 기준으로 임계값 동적 조정
- 시장 상황에 따른 적응적 분류

### 🧠 **4단계: LSTM 모델 아키텍처**

#### 다중 입력 LSTM 구조 (추천)
```
입력 브랜치:
1. 주가 브랜치: OHLCV + 기술적 지표
2. 뉴스 감정 브랜치: FinBERT 점수들
3. 트위터 감정 브랜치: VADER 점수들

→ 각 브랜치별 LSTM 처리
→ 결합층 (Concatenate)
→ Dense 층 
→ 3클래스 분류 출력 (Softmax)
```

#### 시퀀스 설정
- **시퀀스 길이**: 24-48시간 (조정 가능)
- **예측 범위**: 1-4시간 후 방향성
- **슬라이딩 윈도우**: 1시간씩 이동

### 📈 **5단계: 학습 전략**

#### 데이터 분할
- **시간 순서 유지**: Train 70% → Validation 15% → Test 15%
- **Walk-forward 검증**: 실제 거래 환경 시뮬레이션

#### 클래스 불균형 해결
- **가중치 조정**: Neutral 클래스 비중이 높을 경우
- **SMOTE**: 소수 클래스 오버샘플링
- **Focal Loss**: 어려운 샘플에 집중

### 📊 **6단계: 평가 및 최적화**

#### 모델 평가 지표
- **분류 성능**: F1-score, Precision/Recall (클래스별)
- **실용적 지표**: 거래 수익률, Sharpe ratio
- **신뢰도 분석**: 예측 확률별 정확도

#### 하이퍼파라미터 최적화
- LSTM 유닛 수: 64-256
- 시퀀스 길이: 12-72시간
- 학습률, 배치 크기, Dropout rate

### 🚀 **7단계: 고도화 방향**

#### 추가 데이터 소스
- **시장 지수**: S&P 500, VIX
- **거시경제**: 금리, 환율
- **관련 주식**: 섹터 내 다른 주식들

#### 고급 기법
- **Attention 메커니즘**: 중요한 시점 자동 식별
- **앙상블**: 여러 모델 조합
- **온라인 학습**: 실시간 모델 업데이트

### 💡 **핵심 성공 포인트**

1. **시간 지연 고려**: 감정이 주가에 미치는 영향은 즉각적이지 않을 수 있음
2. **결측치 처리**: 뉴스/트윗이 없는 시간대 적절한 보간
3. **시장 상황 고려**: Bull/Bear 시장에 따른 모델 적응
4. **리스크 관리**: 모델 불확실성 정량화 및 거래 규칙 통합

이 방법론으로 뉴스 감정, 소셜미디어 감정, 기술적 분석을 종합한 강력한 주가 예측 모델을 구축할 수 있을 것입니다! 🎉